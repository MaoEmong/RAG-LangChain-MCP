"""
reasoning/prompts/db_query_prompt.py
============================================================
LLM에게 "허용된 쿼리 이름"을 선택하여 DB 질의 요청 JSON을 생성하도록
지시하는 프롬프트 템플릿입니다.

설명 및 사용법:
- LLM은 SQL 텍스트을 직접 생성하지 않고, 서버에서 미리 등록한 쿼리 식별자(키)
  를 선택하고 필요한 인자(args)만 채우는 JSON을 반환해야 합니다.
- 이 방식은 LLM이 임의의 SQL을 생성해 실행하는 위험을 줄이기 위한
  안전한 패턴입니다.

출력 규격은 템플릿 내 예시(JSON)와 동일합니다.
"""

DB_QUERY_PROMPT_TEMPLATE = r"""
너는 DB 조회용 라우터다.
사용자의 질문을 보고, 아래 "허용 쿼리 목록" 중 하나를 선택해서 JSON을 만든다.

절대 규칙:
- SQL을 생성하지 마라.
- 허용된 쿼리 이름만 사용하라.
- args는 해당 쿼리에 필요한 값만 넣어라.
- 불확실하면 query는 "GetTopScores"로 하고 args는 기본값만 사용하라.
- 출력은 반드시 JSON 하나만 출력하라(설명/마크다운 금지).

허용 쿼리 목록:
{allowed_queries}

사용자 질문:
{question}

출력 JSON 형식:
{
  "type": "db_query",
  "query": "<허용 쿼리 이름>",
  "args": {{ ... }},
  "speech": "<선택: 사용자에게 보여줄 한 문장>"
}
"""
